# AGENTS.md

## üéØ –û–±—â–∞—è —Ü–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–°–æ–∑–¥–∞—Ç—å –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **Call Mom** –Ω–∞ **React Native (Expo, TypeScript)** –¥–ª—è P2P –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–æ–≤ **–±–µ–∑ —Å–µ—Ä–≤–µ—Ä–æ–≤**, —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **WebRTC –≤–Ω—É—Ç—Ä–∏ WebView**.
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç—ã–º: —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤, –ø—Ä–æ—Ñ–∏–ª—å, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ deep links, –∑–≤–æ–Ω–∫–∏ –Ω–∞–ø—Ä—è–º—É—é (offer/answer) –∏ inline-—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.

---

## üõ†Ô∏è –û–±—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

1. **TypeScript only**

   * –í—Å–µ —Ñ–∞–π–ª—ã –ø–∏—Å–∞—Ç—å –Ω–∞ TypeScript (`.ts`, `.tsx`).
   * –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–≥—É—é —Ç–∏–ø–∏–∑–∞—Ü–∏—é.

2. **Expo Managed Workflow**

   * –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å bare workflow –∏ –Ω–∞—Ç–∏–≤–Ω—ã–µ –º–æ–¥—É–ª–∏.
   * –î–ª—è WebRTC –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π HTML/JS –∫–ª–∏–µ–Ω—Ç –≤–Ω—É—Ç—Ä–∏ **WebView**.

3. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞**

   * `screens/` ‚Äî —ç–∫—Ä–∞–Ω—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   * `components/` ‚Äî UI –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
   * `storage/` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å AsyncStorage
   * `utils/` ‚Äî –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
   * `assets/` ‚Äî –∏–∫–æ–Ω–∫–∏/—Ä–µ—Å—É—Ä—Å—ã
   * `README.md`, `AGENTS.md` ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

4. **–°—Ç–∏–ª—å –∫–æ–¥–∞**

   * –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ React Hooks.
   * –ò–∑–±–µ–≥–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã.
   * –ü–∏—Å–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (JSDoc –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞).
   * –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `async/await`, –Ω–µ `then/catch`.

---

## üì± –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ UX

* **–•–µ–¥–µ—Ä (Header)**

  * –°–ª–µ–≤–∞: `Call Mom` (—Ç–µ–∫—Å—Ç)
  * –°–ø—Ä–∞–≤–∞: –∏–∫–æ–Ω–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è (–ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω –ø—Ä–æ—Ñ–∏–ª—è)

* **–≠–∫—Ä–∞–Ω—ã**

  1. **Contacts List**

     * –°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ (–∞–≤–∞—Ç–∞—Ä —Å –∏–Ω–∏—Ü–∏–∞–ª–∞–º–∏, –∏–º—è, chevron).
     * –ü—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ ‚Üí —Å–æ–æ–±—â–µ–Ω–∏–µ: ‚ÄúNo contacts yet. Share your profile to add.‚Äù

  2. **Profile Screen**

     * –ü–æ–ª–µ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏ (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ AsyncStorage).
     * –ö–Ω–æ–ø–∫–∞ **‚ÄúShare my contact‚Äù** ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç deep link –≤–∏–¥–∞ `callmom://addContact?...` –∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Share Sheet.

  3. **Contact Detail**

     * –•–µ–¥–µ—Ä —Å –∏–º–µ–Ω–µ–º + –∏–∫–æ–Ω–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (inline TextInput).
     * –í–Ω–∏–∑—É: –∑–µ–ª—ë–Ω–∞—è –∫—Ä—É–≥–ª–∞—è –∫–Ω–æ–ø–∫–∞ –∑–≤–æ–Ω–∫–∞ (–∏–∫–æ–Ω–∫–∞ `phone`).

  4. **Incoming Call Modal**

     * –ò–º—è –∑–≤–æ–Ω—è—â–µ–≥–æ.
     * –î–≤–µ –∫–Ω–æ–ø–∫–∏: Accept (–∑–µ–ª—ë–Ω–∞—è), Decline (–∫—Ä–∞—Å–Ω–∞—è).

  5. **In-Call Overlay**

     * –í–∏–¥–µ–æ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞ –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω.
     * –õ–æ–∫–∞–ª—å–Ω–æ–µ –≤–∏–¥–µ–æ –º–∞–ª–µ–Ω—å–∫–∏–º –∫—Ä—É–∂–∫–æ–º –≤–≤–µ—Ä—Ö—É —Å–ø—Ä–∞–≤–∞.
     * –í–Ω–∏–∑—É ‚Äî –∫—Ä–∞—Å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ ‚ÄúEnd Call‚Äù.
     * –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –∫–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã.

* **–¶–≤–µ—Ç–∞**

  * –ó–µ–ª—ë–Ω—ã–π –∑–≤–æ–Ω–∫–∞: `#10B981`
  * –ö—Ä–∞—Å–Ω—ã–π –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è: `#EF4444`
  * –¢–µ–∫—Å—Ç: –ø–æ—á—Ç–∏ —á—ë—Ä–Ω—ã–π `#0F172A`
  * –§–æ–Ω: `#FFFFFF` / `#F7F7F8`

---

## üîó Deep Links (callmom://)

* **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞**

  ```
  callmom://addContact?d=<base64(JSON)>
  ```

  JSON:

  ```json
  { "id": "<uuid>", "name": "John Doe", "createdAt": "<ISO>" }
  ```

* **–ò—Å—Ö–æ–¥—è—â–∏–π –∑–≤–æ–Ω–æ–∫ (offer)**

  ```
  callmom://incomingCall?from=<base64(name+id)>&sdp=<base64(offerSdp)>
  ```

* **–û—Ç–≤–µ—Ç –Ω–∞ –∑–≤–æ–Ω–æ–∫ (answer)**

  ```
  callmom://callAnswer?from=<base64(name+id)>&sdp=<base64(answerSdp)>
  ```

---

## üíæ –î–∞–Ω–Ω—ã–µ

* **Profile**

  ```ts
  { id: string, name: string }
  ```

* **Contact**

  ```ts
  { id: string, name: string, createdAt: string, raw: string }
  ```

* **–•—Ä–∞–Ω–µ–Ω–∏–µ**

  * –í `AsyncStorage` (profile.ts, contacts.ts).

---

## üìπ WebRTC —á–µ—Ä–µ–∑ WebView

* –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π HTML + JS –∫–ª–∏–µ–Ω—Ç, –≤—ã–ø–æ–ª–Ω—è—é—â–∏–π:

  * `getUserMedia({ video: { facingMode: 'user' }, audio: true })`
  * `RTCPeerConnection` c STUN: `stun:stun.l.google.com:19302`
  * –°–±–æ—Ä ICE-–∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ ‚Üí –¥–æ–∂–¥–∞—Ç—å—Å—è `iceGatheringState = complete` ‚Üí –æ—Ç–ø—Ä–∞–≤–∏—Ç—å SDP —á–µ—Ä–µ–∑ `postMessage`.

* **–ü—Ä–æ—Ç–æ–∫–æ–ª —Å–æ–æ–±—â–µ–Ω–∏–π RN ‚Üî WebView**

  * RN ‚Üí WebView:

    * `{ type: 'createOffer' }`
    * `{ type: 'setRemoteOffer', sdp }`
    * `{ type: 'setRemoteAnswer', sdp }`
    * `{ type: 'hangup' }`
    * `{ type: 'switchCamera' }`

  * WebView ‚Üí RN:

    * `{ type: 'offer', sdp }`
    * `{ type: 'answer', sdp }`
    * `{ type: 'connected' }`
    * `{ type: 'error', message }`

---

## ‚ö†Ô∏è –û—à–∏–±–∫–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

* –ï—Å–ª–∏ ICE-–∫–∞–Ω–¥–∏–¥–∞—Ç—ã –Ω–µ —Å–æ–±—Ä–∞–ª–∏—Å—å ‚Üí —Å–æ–æ–±—â–µ–Ω–∏–µ:
  *‚ÄúDirect connection failed. Try same Wi-Fi or another network.‚Äù*
* –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö WebRTC –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é Toast/Alert.
* –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–º–∏ SDP ‚Üí –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ/–≤—Å—Ç–∞–≤–∫—É –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ QR.
* TURN-—Å–µ—Ä–≤–µ—Ä–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º (—á—Ç–æ–±—ã –æ—Å—Ç–∞—Ç—å—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é P2P).

---

## ‚úÖ Acceptance Criteria

* –í—Å–µ —ç–∫—Ä–∞–Ω—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –ø–æ –¥–∏–∑–∞–π–Ω—É.
* Deep links –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–æ–±–∞–≤–ª—è—é—Ç –∫–æ–Ω—Ç–∞–∫—Ç—ã –∏ –∏–Ω–∏—Ü–∏–∏—Ä—É—é—Ç –∑–≤–æ–Ω–∫–∏.
* –í–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ–±–º–µ–Ω–µ offer/answer —Å—Å—ã–ª–∫–∞–º–∏.
* –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–≤–æ–Ω–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã.
* –û—à–∏–±–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
* –ö–æ–¥ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º —Å Expo Managed workflow.